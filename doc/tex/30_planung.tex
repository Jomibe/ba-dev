\chapter{Planung}

In diesem Kapitel wird die Planung der Software mit Prinzipien des Softwareengineerings erläutert. 

\section{Auswahl der Programmiersprache}

Die Software soll in der Skriptsprache Python entwickelt werden. Die Programmiersprache bietet eine einmalige Kombination von Vorteilen gegenüber anderen populären Programmiersprachen: die Plattformunabhängigkeit wird durch die Verfügbarkeit von Interpretern sowohl für unixoide Betriebssysteme als auch Windows ermöglicht. Die Software liegt jederzeit im Quellcode vor und kann so einfach gewartet und erweitert werden. Des weiteren existiert aufgrund der hohen Popularität \footnote{https://www.tiobe.com/tiobe-index/python/} eine reichhaltige Auswahl an Bibliotheken und Onlinedokumentationen, welche die Entwicklung der Software vereinfachen. 

\section{Anforderungen}

\subsection{Systemumgebung}

Die Software soll auf den nicht interaktiven Betrieb als Dienst auf unixoiden Betriebssystemen ausgelegt werden. Dies hat u.A. Auswirkungen auf die geplanten Benutzerschnittstellen. Das Programm soll zur Laufzeit keine Konsoleneingaben verlangen, da diese nur bei einem interaktiven Betrieb, z.B. in der Shell, vorgenommen werden können. Stattdessen soll mit dem Anwender vollständig über den Telegram-Messenger interagiert werden und administrative Einstellungen sollen über Konfigurationsdateien vorgenommen werden können. Zur Anwendung von geänderten Einstellungen ist u.U. ein Neustart der Software notwendig. Die Software sollte daher zustandslos arbeiten, um einen möglichen Verlust von eingegangenen und noch nicht verarbeiteten Daten zu verhindern. Weiterhin sollte die durch einen Neustart verursachte Ausfallzeit so gering wie möglich gehalten werden. Die Software soll Ereignismeldungen über die Standardausgabe sowie über eine textbasierte Protokolldatei ausgeben, um Fehleranalysen zu vereinfachen.

\subsection{Systemkonfiguration}
Für den Betrieb der Software ist eine vorinstallierte Python 3 Umgebung notwendig. Die benötigten Bibliotheken sollen über den Paketmanager pip bezogen und aktuell gehalten werden können. Auch wenn die Software auf den Betrieb als Dienst ausgelegt werden soll, soll eine interaktive Verwendung sowohl mit unixoiden Betriebssystemen als auch mit Windows möglich sein. Weiterhin muss eine Verbindung zum Internet über die Protokolle HTTP und HTTPS möglich sein, um mit externen Diensten kommunizieren zu können.

\section{Programmablauf}

\subsection{Grundsätzlicher Aufbau}

Nach dem Start der Software muss geprüft werden, ob ein einwandfreier Betrieb möglich ist. Dazu ist es notwendig, die Erreichbarkeit und Funktion sämtlicher Dienste mittels geeigneter API-Abfragen zu prüfen. Nachdem die Vorbereitungen abgeschlossen sind, kann in den Regelbetrieb übergegangen werden, in welchem sich das Programm bis zum Programmende befindet. 

\subsection{Regelbetrieb}

Im Regelbetrieb reagiert die Software in Echtzeit auf eingehende Nachrichten vom Anwender. 
Um den Betrieb der Software auch mit nicht-öffentlichen IP-Adressen (beispielsweise in einem Heimnetzwerk hinter einem NAT-Router oder einer Firewall) zu ermöglichen, soll das Verfahren des \lstinline{long-polling} für den Abruf von Informationen von der Telegram API verwendet werden (vgl. \autoref{sec:telegram-getting-updates}).

Trifft eine Nachricht ein, muss wie folgt verfahren werden: 

\begin{enumerate}
\item Benutzerautorisierung prüfen (der Bot ist öffentlich erreichbar, eine Zugriffsbeschränkung seitens Telegram ist nicht vorgesehen)
\item Prüfung der Nachrichtenbestandteile
\subitem 2.1 Bei einer Sprachnachricht: Transkribieren der Audiodatei in Text
\item Erfassung der für eine Abfrage notwendigen Informationen
\item Stellen der Abfrage an das Graylog-Backend
\item Erhalten einer Antwort vom Graylog-Backend
\item Einbetten der erhaltenen Rohdaten in einen Nachrichtentext
\item Umwandeln des Texts in eine Audiodatei mittels Text-To-Speech
\item Senden einer Antwort an den Absender der Nachricht. Audiodatei als Sprachnachricht der Nachricht anhängen.
\end{enumerate}

\subsection{Spracherkennung}

Bei der Ausarbeitung eines Konzepts für die Funktionsweise der Spracherkennung müssen einige funktionale und nicht-funktionale Eigenschaften beachtet werden. Die Entscheidung wird u.A. beeinflusst durch Aspekte der... 

\begin{itemize}
\item Erweiterbarkeit: es soll einfach und insbesondere ohne ein notwendiges Training von Sprachmodellen möglich sein, neue Systeme und Abfragen zu definieren.
\item Fehlertoleranz: gesprochene Sprache enthält Umgangssprache und verändert sich durch grammatikalische Eigenschaften je nach Satzbau leicht in der Aussprache. Die Erkennung muss trotz dieser Veränderungen zuverlässig funktionieren.
\item Rechenkapazität: die Geschwindigkeit (Wartezeit während dem Vorgang) der Spracherkennung sollte nicht von limitierten Rechenressourcen oder der Länge der zu übersetzenden Sprache abhängen.
\item finanziellen Kosten: diese sollten möglichst gering gehalten werden.
\item Plattformunabhängigkeit: die Software und ggf. trainierte Modelle sollten wie die gewählte Programmiersprache Python plattformunabhängig und portabel sein.
\item Nachvollziehbarkeit: während der Entwicklung und bei der Definition neuer Begriffe sollten auftretende Fehler einfach erkenn- und behebbar sein.
\item Sprache: das System soll Sätze verstehen, welche Begriffe aus mehreren Sprachen (deutsch und englisch) beinhalten.
\end{itemize}

Es bestehen verschiedene Möglichkeiten, Sprache zu Text zu transkribieren und den Inhalt im Anschluss zu analysieren, um das Anliegen des Anwenders zu erkennen und eine passende Anfrage für die Suchmaschine in Graylog zu bilden. Für die Transkription ist es notwendig, künstliche Intelligenz einzusetzen. Diese kann lokal oder entfernt ausgeführt werden. Die entfernte Ausführung bietet Vorteile bezüglich der Plattformunabhängigkeit und der (von den lokalen Ressourcen unabhängigen) Geschwindigkeit. Es stehen verschiedene gleichwertige Online-Dienste für die Transkription zur Verfügung, darunter "Watson Speech to Text" von IBM und "Amazon Transcribe" von AWS.

\subsubsection{Syntax}

Liegt die eingegangene Nachricht als Text vor, müssen die Inhalte analysiert werden. Aufgrund des notwendigen Trainings für neue Begriffsdefinitionen ist der Einsatz von künstlicher Intelligenz bei dieser Programmkomponente nicht sinnvoll. Der Aufbau der Nachricht muss stattdessen einem festen Muster folgen, welches durch eine Prozedur analysiert werden kann. Hierzu eignet sich die Verwendung von Schlüsselwörtern. Diese bieten den Vorteil, dass keine Analyse der Grammatik notwendig ist. Um die Erweiterung zu vereinfachen, wird ein Aufbau aus Produktkategorie, Eigenschaft und Zeitraum gewählt. Die Produktkategorie entspricht der abzufragenden Gerätegruppe, beispielsweise \lstinline{Webserver}. Für jede Produktkategorie können Eigenschaften definiert werden, für die Abfrage von Ereignissen mit einem Statuscode \lstinline{4xx} oder \lstinline{5xx} der Gruppe \lstinline{Webserver} beispielsweise \lstinline{Fehlermeldungen}. Ein weiteres Schlüsselwort führt zu den Informationen für den abzufragenden Zeitraum, welcher relativ angegeben wird (\lstinline{letzte fünf Tage}, \lstinline{letzte Woche}, \lstinline{letzte 20 Minuten}). Schließlich muss die Erkennung von Zahlwörtern zuverlässig funktionieren.
